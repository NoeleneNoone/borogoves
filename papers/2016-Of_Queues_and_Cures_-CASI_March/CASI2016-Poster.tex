%\documentclass[landscape,a0b,final,a4resizeable]{a0poster}
%\documentclass[landscape,a0b,final]{a0poster}
%\documentclass[portrait,a0b,final,a4resizeable]{a0poster}
\documentclass[portrait,a0b,final]{a0poster}
%%% Option "a4resizeable" makes it possible ot resize the
%   poster by the command: psresize -pa4 poster.ps poster-a4.ps
%   For final printing, please remove option "a4resizeable" !!

\usepackage{epsfig}
\usepackage{multicol}
\usepackage{pstricks,pst-grad}
\usepackage{calc}
\usepackage{xspace}
%\usepackage{algorithm}
%\usepackage{algorithmic}

\newcommand{\tcptraceroute}{\texttt{tcp\-trace\-route}\xspace}
\newcommand{\tcpdump}{\texttt{tcp\-dump}\xspace}
\newcommand{\IPID}{IP-ID\xspace}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definition of some variables and colors
%\renewcommand{\rho}{\varrho}
%\renewcommand{\phi}{\varphi}
\setlength{\columnsep}{3cm}
\setlength{\columnseprule}{2mm}
\setlength{\parindent}{0.0cm}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%               Background                     %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\background}[3]{
  \newrgbcolor{cgradbegin}{#1}
  \newrgbcolor{cgradend}{#2}
  \psframe[fillstyle=gradient,gradend=cgradend,
  gradbegin=cgradbegin,gradmidpoint=#3](0.,0.)(1.\textwidth,-1.\textheight)
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                Poster                        %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{poster}{
  \begin{center}
  \begin{minipage}[c]{0.98\textwidth}
}{
  \end{minipage} 
  \end{center}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                pcolumn                       %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{pcolumn}[1]{
  \begin{minipage}{#1\textwidth}
  \begin{center}
}{
  \end{center}
  \end{minipage}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                pbox                          %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newrgbcolor{lcolor}{0. 0. 0.80}
\newrgbcolor{gcolor1}{1. 1. 1.}
\newrgbcolor{gcolor2}{.80 .80 1.}

\newcommand{\pbox}[4]{
\psshadowbox[#3]{
\begin{minipage}[t][#2][t]{#1}
#4
\end{minipage}
}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                myfig                         %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \myfig - replacement for \figure
% necessary, since in multicol-environment 
% \figure won't work

\newcommand{\myfig}[3][0]{
\begin{center}
  \vspace{1.5cm}
  \includegraphics[width=#3\hsize,angle=#1]{#2}
  \nobreak\medskip
\end{center}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                mycaption                     %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \mycaption - replacement for \caption
% necessary, since in multicol-environment \figure and
% therefore \caption won't work

%\newcounter{figure}
\setcounter{figure}{1}
\newcommand{\mycaption}[1]{
  \vspace{0.5cm}
  \begin{quote}
    {{\sc Figure} \arabic{figure}: #1}
  \end{quote}
  \vspace{1cm}
  \stepcounter{figure}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Begin of Document
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\background{1. 1. 1.}{1. 1. 1.}{0.5}

\vspace*{2cm}


\newrgbcolor{lightblue}{0. 0. 0.80}
\newrgbcolor{white}{1. 1. 1.}
\newrgbcolor{whiteblue}{.80 .80 1.}


\begin{poster}

%%%%%%%%%%%%%%%%%%%%%
%%% Header
%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\begin{pcolumn}{0.98}

\pbox{0.95\textwidth}{}{linewidth=2mm,framearc=0.3,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{

%%% Unisiegel
\begin{minipage}[c][9cm][c]{0.1\textwidth}
  \begin{center}
  \end{center}
\end{minipage}
%%% Titel
\begin{minipage}[c][9cm][c]{0.78\textwidth}
  \begin{center}
    {\sc \Huge Analysis of ICMP Quotations}\\[10mm]
    {\Large David Malone and Matthew Luckie\\[7.5mm]
    Hamilton Institute, NUI Maynooth and WAND Group, University of Waikato.}
  \end{center}
\end{minipage}
%%% GK-Logo
\begin{minipage}[c][9cm][c]{0.1\textwidth}
  \begin{center}
  \end{center}
\end{minipage}
}

\end{pcolumn}
\end{center}


\vspace*{2cm}



%%%%%%%%%%%%%%%%%%%%%
%%% Content
%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\begin{pcolumn}{0.32}
\pbox{0.9\textwidth}{30cm}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=white,gradmidpoint=1.0,framesep=1em}{
\medskip
%%% Abstract
\begin{center}\pbox{0.8\textwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}ICMP Quotations\end{center}}\end{center}\vspace{1.25cm}

\smallskip

\begin{itemize}
\item
RFC 792: ICMP error messages quote packet causing error.
\item
Allows ICMP errors to be directed to correct higher layer instance.
\item
IP header and at least next eight bytes to be quoted.
\item 
Interested in when the quote does not match what was sent.
\item
Should be able to see expected changes (TTL, DSCP, ECN).
\item
May be able to see NAT, packet scrubbing.
\end{itemize}

\bigskip

\begin{center}
\begin{tabular}{ccc}
No Change & Infilight Change & Change by Quoter \\
\includegraphics[width=\textwidth*\real{0.28}]{icmpprobe} &
\includegraphics[width=\textwidth*\real{0.28}]{icmpprobe-iflight} &
\includegraphics[width=\textwidth*\real{0.28}]{icmpprobe-quoter}
\end{tabular}
\end{center}

}
\end{pcolumn}
%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%
\begin{pcolumn}{0.32}
\pbox{0.9\textwidth}{30cm}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=white,gradmidpoint=1.0,framesep=1em}{

\medskip
%%% Introduction
\begin{center}\pbox{0.8\textwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Data Set\end{center}}\end{center}\vspace{1.25cm}

\bigskip
\begin{itemize}
\item \tcptraceroute to 84393 web servers used in Medina2004.
\item Probe each hop once with TCP SYN to port 80.
\item Probe had TCP ECE and CWR set, IP DSCP/ECN set to 0x0f, DF set.
\item Collect TCP SYN and ICMP errors with \tcpdump.
\item Data collected 6--12 May 2005.
\item 1190351 probes sent.
\item 858090 ICMP responses matched from 53768 unique IPs, 9 unmatched.

%	836456 time exceeded,
%	21525 were of type unreachable,
%	109 were of type source quench.
%	9 ICMP messages were unmatched.
\end{itemize}
\bigskip
\begin{center}
\begin{tabular}{cc}
\includegraphics[width=\textwidth*\real{0.48}]{icmp-response-breakdown.eps} &
\includegraphics[width=\textwidth*\real{0.48}]{rtt-histo.eps}
\end{tabular}
\end{center}
}
\end{pcolumn}
%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%
\begin{pcolumn}{0.32}
\pbox{0.9\textwidth}{30cm}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=white,gradmidpoint=1.0,framesep=1em}{
\medskip
%%% Abstract
\begin{center}\pbox{0.8\textwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Matching Responses to Probes\end{center}}\end{center}\vspace{1.25cm}

\begin{itemize}
\item Want to match responses to probes.
\item Want to also allow possible modification.
\item Use heuristic designed based on observed data.
\begin{enumerate}
\item Keep list of 25 most recent probes and most recent probe
	with each \IPID.
\item If quoted \IPID matches \IPID or byte-swapped \IPID
	in 25 most recent, then match.
\item Otherwise \IPID substantially altered or response delayed.
\item Select probe from 25 most recent and matching/byte-swapped
	\IPID meeting most of:
	\begin{itemize}
	\item matching destination IP,
	\item matching source port,
	\item matching sequence number,
	\item no previous matching response,
	\item in last 1200 sent.
	\end{itemize}
\item If at least one of \IPID, destination IP, source port or
	sequence number agree, then match.
\end{enumerate}
\item Unusual matches manually inspected and appeared genuine.
\item Some probes had a long RTTs:  56 over 10s, 34 over
	100s, 30 over 300s.

\end{itemize}


}
\end{pcolumn}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ROW 2                                                                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vspace*{2cm}

%%%%%%%%%%%%%%%%%%%%%
%%% Content
%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\begin{pcolumn}{0.32}
\pbox{0.9\textwidth}{30cm}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=white,gradmidpoint=1.0,framesep=1em}{

\medskip
%%% Introduction
\begin{center}\pbox{0.8\textwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Classification of Changes\end{center}}\end{center}\vspace{1.25cm}


\begin{description}
\item[Modification Classification]\ \\[-1cm]
\begin{itemize}
\item Some modifications change single field showing no relation to
	other changes. Classify as zeroed, byte-swapped, incremented or
	changed.
\item Some modifications change set of fields coherently. E.g. insert
	TCP MSS option = increase IP length, increase TCP HL, add option,
	recalculate checksums. Classify as single change.
\item Some modifications overwrite series of consecutive fields. Classify
	as clobbering of fields.
\end{itemize}
\item[Spacial Classification]\ \\[-1cm]
\begin{itemize}
\item A modification seen at one hop but not the next, is classed
	as {\em quoter} modification.
\item A modification observed at adjacent hops with valid IP or TCP
	checksum, is classed as {\em in-flight} modification.
\item A modification observed at a hop with no responses from
	adjacent hops is classed as {\em edge} modification.
\end{itemize}
\item[Observability of Changes]\ \\[-1cm]
\begin{itemize}
\item Most quoters (87.60\%) quote 28 bytes, the minimum in RFC 792.
\item Some quoters (8.60\%) quote 40 bytes, the size of the probe.
\item Some quoters (2.14\%) quote 140 bytes, using ICMP MPLS extensions.
\item Therefore, at least 10.7\% of quoters quote complete IP and TCP headers.
\item Some quoters do strange things (e.g.~CERT VU\#471084 quoting 60 bytes).
\end{itemize}
\end{description}
}
\end{pcolumn}
%%%%%%%%%%%%%%%%%%%%%%
\begin{pcolumn}{0.32}
\pbox{0.9\textwidth}{30cm}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=white,gradmidpoint=1.0,framesep=1em}{

\medskip
%%% Introduction
\begin{center}\pbox{0.8\textwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Observed Modifications\end{center}}\end{center}\vspace{1.25cm}

\begin{description}
\item[Modifications to IP/TCP by quoter]\ \\[-1cm]
{\small 
\begin{center}
\begin{tabular}{|l|r|r|r|r|r|}
\hline
 Modification &    In-flight &      Quoter &         Edge & Total Unique \\
\hline
   IPTOS\_MOD & 1533 (2.9\%) & 146 (0.3\%) & 1674 (3.1\%) & 3030 (5.6\%) \\
  IPLEN\_SWAP &    0 (0.0\%) &   0 (0.0\%) &    1 (0.0\%) &    1 (0.0\%) \\
   IPLEN\_MOD &    0 (0.0\%) & 174 (0.3\%) &  322 (0.6\%) &  480 (0.9\%) \\
   IPID\_SWAP &    0 (0.0\%) &  29 (0.1\%) &  469 (0.9\%) &  494 (0.9\%) \\
    IPID\_MOD &    0 (0.0\%) &   1 (0.0\%) &   19 (0.0\%) &   20 (0.0\%) \\
    IPDF\_MOD &    4 (0.0\%) &   1 (0.0\%) &   30 (0.1\%) &   35 (0.1\%) \\
  IPOFF\_SWAP &    0 (0.0\%) &  32 (0.1\%) &   49 (0.1\%) &   80 (0.2\%) \\
   IPDST\_MOD &   29 (0.1\%) &  36 (0.1\%) & 1189 (2.2\%) & 1248 (2.3\%) \\
\hline
  TCPSRC\_MOD &    0 (0.0\%) &   3 (0.0\%) &   43 (0.1\%) &   46 (0.1\%) \\
  TCPDST\_MOD &    1 (0.0\%) &   2 (0.0\%) &  129 (0.2\%) &  132 (0.3\%) \\
  TCPSEQ\_MOD &    1 (0.0\%) &   0 (0.0\%) &   12 (0.0\%) &   13 (0.0\%) \\
  TCPACK\_MOD &    0 (0.0\%) &   0 (0.0\%) &   19 (0.0\%) &   19 (0.0\%) \\
\hline
  TCPMSS\_ADD &    4 (0.0\%) &   0 (0.0\%) &   19 (0.0\%) &   23 (0.0\%) \\
\hline
\end{tabular}
\end{center}
}
\item[Example Clobbers]\ \\[-1cm]
{\small
\begin{center}
\begin{tabular}{ll}
\texttt{2b4f4b20555345520100000079207365742c206d} & \texttt{+OK USER....y set, m} \\
\texttt{5041535320726963010000000d0a6e6e65637469} & \texttt{PASS ric....  nnecti} \\
\texttt{000000000000a3fd00c467d345484c4f2074786d} & \texttt{..........g.EHLO txm} \\
\texttt{474554202f6988392bcf86c2696c644f7665726c} & \texttt{GET /i.9+...ildOverl} \\
\texttt{0000000000005368696c6c792d5368616c6c797c} & \texttt{......Shilly-Shally|} \\

\texttt{45534d54502053756e2c2030}                 & \texttt{ESMTP Sun, 0} \\
\texttt{6564205065726d616e656e74}                 & \texttt{ed Permanent} \\
\texttt{0a4167653a20313333360d0a}                 & \texttt{ Age: 1336  }\\
\texttt{0a5365742d436f6f6b69653a}                 & \texttt{ Set-Cookie:} \\
\texttt{6374696f6e223e3c623e4d61}                 & \texttt{ction"><b>Ma} \\
\end{tabular}
\end{center}
}
\end{description}


}
\end{pcolumn}
%%%%%%%%%%%%%%%%%%%%%%
\begin{pcolumn}{0.32}
\pbox{0.9\textwidth}{30cm}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=white,gradmidpoint=1.0,framesep=1em}{

\medskip
%%% Introduction
\begin{center}\pbox{0.8\textwidth}{}{linewidth=2mm,framearc=0.1,linecolor=lightblue,fillstyle=gradient,gradangle=0,gradbegin=white,gradend=whiteblue,gradmidpoint=1.0,framesep=1em}{\begin{center}Modifications of Note\end{center}}\end{center}\vspace{1.25cm}


\begin{description}
\item[IP Header]\ \\[-1cm]
	\begin{itemize}
	\item 1533 quoters made in-flight modification to DSCP/ECN.
	\item Some clear DSCP value, some clear both DSCP and ECN.
	\item Some evidence of consistent DSCP value being assigned.
	\item Small number of in-flight modifications to destination
		IP, some using RFC 1918 addresses.
	\item 4 quoters seen clearing DF bit in flight.
	\item Quoter modification: add IP header
		length to IP length field, sometimes byte-swapping.
	\end{itemize}
\item[TCP Header]\ \\[-1cm]
	\begin{itemize}
	\item Many more edge changes.
	\item 132 quoters showed modifications to destination port.
	\item Some show signs of port redirection to port 81, 8080.
	\item 46 quoters showed modifications to source port, less coherent.
	\item 23 quoters revealed an MSS option added.
	\item MSS values of 536, 1360 1414, 1436 and 1460 seen.
	\end{itemize}
\end{description}

}
\end{pcolumn}
%%%%%%%%%%%%%%%%%%%%%%
\end{center}

\end{poster}

\end{document}

